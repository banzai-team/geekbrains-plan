# Описание ML решения

Это MVP ИИ-решения на общественно-социальной платформе, которое помогает определить, какую программу обучения стоит изучить, чтобы приобрести необходимые навыки и знания для успешного трудоустройства. Решение анализирует требования к кандидатам в вакансиях и предлагает персонализированные рекомендации образовательных курсов GeekBrains, соответствующих потребностям рынка труда.

## Подготовка данных

- Парсинг HTML курсов с помощью [trafilatura](https://trafilatura.readthedocs.io/en/latest/)[2]
- Извлечение навыков из курсов с использованием LLM и информации с сайта курса
- Кластеризация курсов по названию и текстовому описанию навыков:
  - Получение эмбедингов с помощью Sentence-BERT
  - Построение таксономии на основе иерархической кластеризации

## Выбор подходящего курса

Рассмотрены несколько подходов:
1. Генерация фичей на основе LLM в онлайне для последующей обработки легкими моделями:
   - Минусы: для генерации крайне дорого; нужен очень качественный выбор категориальных фичей, чтобы передать как можно больше информации на след этап; требуется сбалансированная разметка таргета.

2. Обучение маленьких энкодеров:
   - Плюсы: быстрая работа моделей.
   - Минусы: нужна сбалансированная разметка таргета; переобучение при добавлении курсов; необходима тренировка для новых фичей.

3. Прямой выбор курса через LLM:
   - Плюсы: нужно сгенерировать всего пару токенов в формате Multiple Choice, легко добавлять фичи, не требует дообучения.
   - Минусы: большой контекст, много противоречивых курсов.

4. Поэтапное сужение количества вариантов:
   - Плюсы: быстро, легко контролировать генерацию в формате Multiple Choice, хорошо работает, можно собрать разметку для дистилляции в маленькую модель.

Выбран подход поэтапного сужения количества вариантов с использованием контролируемой генерации на основе LLM в формате Multiple Choice (https://github.com/guidance-ai/guidance/). Это позволяет быстро и эффективно выбирать курсы, легко добавлять новые фичи и не требует переобучения при добавлении новых курсов.

Пример: 

```
Напиши номер категории, к которой вакансия относится больше всего:
1. Информационные технологии
2. Финансы
3. Кино и видео
4. Дизайн
5. Маркетинг
6. Аналитика
<|eot_id|><|start_header_id|>assistant<|end_header_id|>

1<|eot_id|><|start_header_id|>user<|end_header_id|>

Напиши номер категории, к которой вакансия относится больше всего:
1. Компьютерная грамотность
2. Кибернетика умных устройств
3. Управление проектами и продуктами
4. Разработка ПО
5. Тестирование ПО
6. Искусственный интеллект
7. DevOps-инженер
8. Базы данных
9. Информационная безопасность
10. Сетевые технологии
11. Разработка игр
<|eot_id|><|start_header_id|>assistant<|end_header_id|>

4<|eot_id|><|start_header_id|>user<|end_header_id|>

Напиши номер категории, к которой вакансия относится больше всего:
1. Для детей
2. Для взрослых
<|eot_id|><|start_header_id|>assistant<|end_header_id|>

2<|eot_id|><|start_header_id|>user<|end_header_id|>

Напиши номер категории, к которой вакансия относится больше всего:
1. Веб разработка
2. Разработка программного обеспечения
3. Мобильная разработка
4. Бэкенд разработка
5. Разработка на C#
6. Разработка на Python
7. 1С-разработчик
<|eot_id|><|start_header_id|>assistant<|end_header_id|>

6<|eot_id|><|start_header_id|>user<|end_header_id|>

Напиши номер категории, к которой вакансия относится больше всего:
1. Python-разработчик
2. Fullstack-разработчик
<|eot_id|><|start_header_id|>assistant<|end_header_id|>

1<|eot_id|><|start_header_id|>user<|end_header_id|>

Напиши номер категории, к которой вакансия относится больше всего:
1. Junior
2. Middle
<|eot_id|><|start_header_id|>assistant<|end_header_id|>

2<|eot_id|><|start_header_id|>user<|end_header_id|>
```


## Фичи

### Сопоставление навыков после курса и выбранной вакансии
- Контролируемая генерация для каждого навыка с проставлением одной из трех категорий:
  - Навык не нужен для вакансии
  - Навык может быть полезен для вакансии 
  - Навык необходим для вакансии

### Похожесть курсов
- Оценка похожести курсов по шкале от 1 до 10 на основе навыков и заголовков с помощью LLM
- Используется для рекомендаций в блоке "Может быть интересно"

### Оценка пригодности курса для трудоустройства
- Контролируемая генерация рейтинга от 1 до 9 по вопросу "Можно ли сразу после курса приступать к работе по профессии в вакансии?" после выбора самого подходящего курса и сопоставления навыков

### Определение необходимости управленческих навыков
- Контролируемая генерация ответа на вопрос "Нужно ли управлять людьми в вакансии?"
- Если да, то дополнительно рекомендуется курс Project Manager


### Junior/Middle
- Обработка таксономии для введения категорий junior и middle по специальностям

## Технологии

- [trafilatura](https://trafilatura.readthedocs.io/en/latest/) - для парсинга веб-страниц
- [Guidance](https://github.com/guidance-ai/guidance/) - для контролируемой генерации
- FastAPI - для создания API
- Transformers - для работы с моделями
- SciPy - для кластеризации
- LLaMA-3 - языковая модель
- [Multilingual-E5-Large](https://huggingface.co/intfloat/multilingual-e5-large) - многоязычная модель для получения эмбедингов, выбранная на основе бенчмарка [encodechka](https://github.com/avidale/encodechka)

## Дальнейшее развитие

- Сбор обратной связи от пользователей для улучшения качества рекомендаций
- Расширение базы курсов и навыков
- Дистилляция модели для ускорения работы и снижения затрат
- Интеграция в веб-сервис или чат-бот для удобного взаимодействия с пользователями

Данный проект демонстрирует возможности применения ИИ для персонализированного выбора образовательных программ под запросы рынка труда. Выбранный подход позволяет быстро создать MVP и в дальнейшем масштабировать решение.
